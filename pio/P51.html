<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Espressif &mdash; OS-Q 0.2 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://docs.OS-Q.com/pio/P51.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
 
<link rel="stylesheet" href="../_static/css/extra.css" type="text/css" />
<script src="../_static/js/bootstrap.min.js"></script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7398081349378542" crossorigin="anonymous"></script>
<!-- <script src="http://dl.platformio.org/misc/abplus.js"></script> -->

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> OS-Q
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">

              <ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">开源协议</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开发平台</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arduino/ide.html">Arduino</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html">PlatformIO</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开源硬件</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Pi/index.html">Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../arduino/index.html">Arduino</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开源框架</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../framework/index.html">开发框架</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lan/index.html">编程语言</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开源模板</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../T/index.html">协议标准</a></li>
<li class="toctree-l1"><a class="reference internal" href="../T/index.html#template">项目模板</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">开源方案</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../S/index.html">技术组件</a></li>
<li class="toctree-l1"><a class="reference internal" href="../S/index.html#solution">技术方案</a></li>
</ul>

<p style="margin-top: 15px;">
    <!-- Docs: Side Navigation -->
    <ins class="adsbygoogle ads"
        style="display:block;background-color: transparent;"
        data-ad-client="ca-pub-7398081349378542"
        data-ad-slot="2509136660"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</p>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OS-Q</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Espressif</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/OS-Q/Docs/blob/master/source/pio/P51.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="espressif">
<h1>Espressif<a class="headerlink" href="#espressif" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference external" href="https://www.youtube.com/watch?v=psMqilqlrRQ">Video: Free Inline Debugging for ESP32 and Arduino Sketches</a></p></li>
</ul>
</section>
<section id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#cpu-frequency" id="id1">CPU Frequency</a></p></li>
<li><p><a class="reference internal" href="#flash-frequency" id="id2">FLASH Frequency</a></p></li>
<li><p><a class="reference internal" href="#flash-mode" id="id3">FLASH Mode</a></p></li>
<li><p><a class="reference internal" href="#external-ram-psram" id="id4">External RAM (PSRAM)</a></p></li>
<li><p><a class="reference internal" href="#debug-level" id="id5">Debug Level</a></p></li>
<li><p><a class="reference internal" href="#upload-speed" id="id6">Upload Speed</a></p></li>
<li><p><a class="reference internal" href="#erase-flash" id="id7">Erase Flash</a></p></li>
<li><p><a class="reference internal" href="#partition-tables" id="id8">Partition Tables</a></p></li>
<li><p><a class="reference internal" href="#embedding-binary-data" id="id9">Embedding Binary Data</a></p></li>
<li><p><a class="reference internal" href="#uploading-files-to-file-system-spiffs" id="id10">Uploading files to file system SPIFFS</a></p></li>
<li><p><a class="reference internal" href="#over-the-air-ota" id="id11">Over-the-Air (OTA)</a></p>
<ul>
<li><p><a class="reference internal" href="#using-jfrog-bintray-free-and-secure-cloud-solution" id="id12">Using JFrog Bintray (free and secure Cloud solution)</a></p></li>
<li><p><a class="reference internal" href="#using-built-in-local-solution" id="id13">Using built-in Local solution</a></p>
<ul>
<li><p><a class="reference internal" href="#authentication-and-upload-options" id="id14">Authentication and upload options</a></p></li>
</ul>
</li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-arduino-framework" id="id15">Using Arduino Framework</a></p></li>
</ul>
</div>
<section id="cpu-frequency">
<h2><a class="toc-backref" href="#id1">CPU Frequency</a><a class="headerlink" href="#cpu-frequency" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:myenv]</span>
<span class="c1">; set frequency to 160MHz</span>
<span class="na">board_build.f_cpu</span> <span class="o">=</span> <span class="s">160000000L</span>
</pre></div>
</div>
</section>
<section id="flash-frequency">
<h2><a class="toc-backref" href="#id2">FLASH Frequency</a><a class="headerlink" href="#flash-frequency" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">40000000L</span></code> (default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">80000000L</span></code></p></li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:myenv]</span>
<span class="c1">; set frequency to 80MHz</span>
<span class="na">board_build.f_flash</span> <span class="o">=</span> <span class="s">80000000L</span>
</pre></div>
</div>
</section>
<section id="flash-mode">
<h2><a class="toc-backref" href="#id3">FLASH Mode</a><a class="headerlink" href="#flash-mode" title="Permalink to this headline">¶</a></h2>
<p>Flash chip interface mode. This parameter is stored in the binary image
header, along with the flash size and flash frequency. The ROM bootloader
in the ESP chip uses the value of these parameters in order to know how to
talk to the flash chip.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:myenv]</span>
<span class="na">board_build.flash_mode</span> <span class="o">=</span> <span class="s">qio</span>
</pre></div>
</div>
</section>
<section id="external-ram-psram">
<h2><a class="toc-backref" href="#id4">External RAM (PSRAM)</a><a class="headerlink" href="#external-ram-psram" title="Permalink to this headline">¶</a></h2>
<p>Framework <a class="reference internal" href="../framework/arduino.html#framework-arduino"><span class="std std-ref">Arduino</span></a>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:myenv]</span>
<span class="na">platform</span> <span class="o">=</span> <span class="s">espressif32</span>
<span class="na">framework</span> <span class="o">=</span> <span class="s">arduino</span>
<span class="na">board</span> <span class="o">=</span> <span class="s">...</span>
<span class="na">build_flags</span> <span class="o">=</span>
    <span class="na">-DBOARD_HAS_PSRAM</span>
    <span class="na">-mfix-esp32-psram-cache-issue</span>
</pre></div>
</div>
<p>Framework <a class="reference internal" href="../framework/espidf.html#espidf"><span class="std std-ref">ESP-IDF</span></a>:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:myenv]</span>
<span class="na">platform</span> <span class="o">=</span> <span class="s">espressif32</span>
<span class="na">framework</span> <span class="o">=</span> <span class="s">espidf</span>
<span class="na">board</span> <span class="o">=</span> <span class="s">...</span>
<span class="na">build_flags</span> <span class="o">=</span>
    <span class="na">-DCONFIG_SPIRAM_CACHE_WORKAROUND</span>
</pre></div>
</div>
<p>More details are located in the official ESP-IDF documentation -
<a class="reference external" href="http://esp-idf.readthedocs.io/en/latest/api-guides/external-ram.html">Support for external RAM</a>.</p>
</section>
<section id="debug-level">
<h2><a class="toc-backref" href="#id5">Debug Level</a><a class="headerlink" href="#debug-level" title="Permalink to this headline">¶</a></h2>
<p>Actual information is available in <a class="reference external" href="https://github.com/espressif/arduino-esp32/blob/master/boards.txt#L80">Arduino for ESP32 Board Manifest</a>.
Please scroll to <code class="docutils literal notranslate"><span class="pre">esp32.menu.DebugLevel</span></code> section.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:myenv]</span>
<span class="na">platform</span> <span class="o">=</span> <span class="s">...</span>
<span class="na">board</span> <span class="o">=</span> <span class="s">...</span>
<span class="na">framework</span> <span class="o">=</span> <span class="s">arduino</span>

<span class="c1">;;;;; Possible options ;;;;;;</span>

<span class="c1">; None</span>
<span class="na">build_flags</span> <span class="o">=</span> <span class="s">-DCORE_DEBUG_LEVEL=0</span>

<span class="c1">; Error</span>
<span class="na">build_flags</span> <span class="o">=</span> <span class="s">-DCORE_DEBUG_LEVEL=1</span>

<span class="c1">; Warn</span>
<span class="na">build_flags</span> <span class="o">=</span> <span class="s">-DCORE_DEBUG_LEVEL=2</span>

<span class="c1">; Info</span>
<span class="na">build_flags</span> <span class="o">=</span> <span class="s">-DCORE_DEBUG_LEVEL=3</span>

<span class="c1">; Debug</span>
<span class="na">build_flags</span> <span class="o">=</span> <span class="s">-DCORE_DEBUG_LEVEL=4</span>

<span class="c1">; Verbose</span>
<span class="na">build_flags</span> <span class="o">=</span> <span class="s">-DCORE_DEBUG_LEVEL=5</span>
</pre></div>
</div>
</section>
<section id="upload-speed">
<h2><a class="toc-backref" href="#id6">Upload Speed</a><a class="headerlink" href="#upload-speed" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:myenv]</span>
<span class="na">upload_speed</span> <span class="o">=</span> <span class="s">9600</span>
</pre></div>
</div>
</section>
<section id="erase-flash">
<h2><a class="toc-backref" href="#id7">Erase Flash</a><a class="headerlink" href="#erase-flash" title="Permalink to this headline">¶</a></h2>
<p>Please <a class="reference internal" href="userguide/cmd_run.html#cmdoption-pio-run-t"><code class="xref std std-option docutils literal notranslate"><span class="pre">pio</span> <span class="pre">run</span> <span class="pre">--target</span></code></a> the next command to erase the entire
flash chip (all data replaced with 0xFF bytes):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="n">pio</span> <span class="n">run</span> <span class="o">--</span><span class="n">target</span> <span class="n">erase</span>

<span class="c1"># or short version</span>

<span class="o">&gt;</span> <span class="n">pio</span> <span class="n">run</span> <span class="o">-</span><span class="n">t</span> <span class="n">erase</span>
</pre></div>
</div>
</section>
<section id="partition-tables">
<h2><a class="toc-backref" href="#id8">Partition Tables</a><a class="headerlink" href="#partition-tables" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">default.csv</span></code> for <a class="reference internal" href="../framework/arduino.html#framework-arduino"><span class="std std-ref">Arduino</span></a>
(<a class="reference external" href="https://github.com/espressif/arduino-esp32/blob/master/tools/partitions">show pre-configured partition tables</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">partitions_singleapp.csv</span></code> for <a class="reference internal" href="../framework/espidf.html#espidf"><span class="std std-ref">ESP-IDF</span></a>
(<a class="reference external" href="https://github.com/espressif/esp-idf/blob/master/components/partition_table">show pre-configured partition tables</a>)</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>SPIFFS partition <strong>MUST</strong> have configured “Type” as “data” and “SubType”
as “spiffs”. For example, <code class="docutils literal notranslate"><span class="pre">spiffs,</span> <span class="pre">data,</span> <span class="pre">spiffs,</span> <span class="pre">0x291000,</span> <span class="pre">1M,</span></code></p>
</div>
<p>Examples:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="c1">; 1) A &quot;partitions_custom.csv&quot; in the root of project directory</span>
<span class="k">[env:custom_table]</span>
<span class="na">board_build.partitions</span> <span class="o">=</span> <span class="s">partitions_custom.csv</span>

<span class="c1">; 2) Switch between built-in tables</span>
<span class="c1">; https://github.com/espressif/arduino-esp32/tree/master/tools/partitions</span>
<span class="c1">; https://github.com/espressif/esp-idf/tree/master/components/partition_table</span>
<span class="k">[env:custom_builtin_table]</span>
<span class="na">board_build.partitions</span> <span class="o">=</span> <span class="s">no_ota.csv</span>
</pre></div>
</div>
</section>
<section id="embedding-binary-data">
<h2><a class="toc-backref" href="#id9">Embedding Binary Data</a><a class="headerlink" href="#embedding-binary-data" title="Permalink to this headline">¶</a></h2>
<p>Sometimes you have a file with some binary or text data that you’d like to
make available to your program - but you don’t want to reformat the file as
C source.</p>
<p>There are two options <code class="docutils literal notranslate"><span class="pre">board_build.embed_txtfiles</span></code> and <code class="docutils literal notranslate"><span class="pre">board_build.embed_files</span></code>
which can be used for embedding data. The only difference is that files specified
in <code class="docutils literal notranslate"><span class="pre">board_build.embed_txtfiles</span></code> option are null-terminated in the final binary.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:myenv]</span>
<span class="na">platform</span> <span class="o">=</span> <span class="s">espressif32</span>
<span class="na">board</span> <span class="o">=</span> <span class="s">...</span>
<span class="na">board_build.embed_txtfiles</span> <span class="o">=</span>
  <span class="na">src/private.pem.key</span>
  <span class="na">src/certificate.pem.crt</span>
  <span class="na">src/aws-root-ca.pem</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case with ESP-IDF, these files also need to be specified in <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code>
using the <code class="docutils literal notranslate"><span class="pre">target_add_binary_data</span></code> function.</p>
</div>
<p>The file contents will be added to the <code class="docutils literal notranslate"><span class="pre">.rodata</span></code> section in flash, and
are available via symbol names as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">aws_root_ca_pem_start</span><span class="p">[]</span><span class="w"> </span><span class="k">asm</span><span class="p">(</span><span class="s">&quot;_binary_src_aws_root_ca_pem_start&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">extern</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">aws_root_ca_pem_end</span><span class="p">[]</span><span class="w"> </span><span class="k">asm</span><span class="p">(</span><span class="s">&quot;_binary_src_aws_root_ca_pem_end&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">extern</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">certificate_pem_crt_start</span><span class="p">[]</span><span class="w"> </span><span class="k">asm</span><span class="p">(</span><span class="s">&quot;_binary_src_certificate_pem_crt_start&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">extern</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">certificate_pem_crt_end</span><span class="p">[]</span><span class="w"> </span><span class="k">asm</span><span class="p">(</span><span class="s">&quot;_binary_src_certificate_pem_crt_end&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">extern</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">private_pem_key_start</span><span class="p">[]</span><span class="w"> </span><span class="k">asm</span><span class="p">(</span><span class="s">&quot;_binary_src_private_pem_key_start&quot;</span><span class="p">);</span><span class="w"></span>
<span class="k">extern</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">private_pem_key_end</span><span class="p">[]</span><span class="w"> </span><span class="k">asm</span><span class="p">(</span><span class="s">&quot;_binary_src_private_pem_key_end&quot;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<p>The names are generated from the full name of the file. Characters <code class="docutils literal notranslate"><span class="pre">/,</span> <span class="pre">.</span></code>,
etc. are replaced with underscores. The <code class="docutils literal notranslate"><span class="pre">_binary</span></code> + <code class="docutils literal notranslate"><span class="pre">_nested_folder</span></code> prefix
in the symbol name is added by “objcopy” and is the same for both text and binary files.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With the ESP-IDF framework symbol names should not contain path to the files, for example
<code class="docutils literal notranslate"><span class="pre">_binary_private_pem_key_start</span></code> instead of <code class="docutils literal notranslate"><span class="pre">_binary_src_private_pem_key_start</span></code>.</p>
</div>
<p>See full example with embedding Amazon AWS certificates:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/platformio/platform-espressif32/tree/develop/examples/espidf-aws-iot">https://github.com/platformio/platform-espressif32/tree/develop/examples/espidf-aws-iot</a></p></li>
</ul>
</section>
<section id="uploading-files-to-file-system-spiffs">
<h2><a class="toc-backref" href="#id10">Uploading files to file system SPIFFS</a><a class="headerlink" href="#uploading-files-to-file-system-spiffs" title="Permalink to this headline">¶</a></h2>
<p>To upload SPIFFS image using OTA update please specify <code class="docutils literal notranslate"><span class="pre">upload_port</span></code> /
<code class="docutils literal notranslate"><span class="pre">--upload-port</span></code> as IP address or mDNS host name (ending with the <code class="docutils literal notranslate"><span class="pre">*.local</span></code>).</p>
<p>Examples:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/espressif/arduino-esp32/tree/master/libraries/SPIFFS/examples">SPIFFS for Arduino</a></p></li>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/tree/master/examples/storage/spiffs">SPIFFS for ESP-IDF</a></p></li>
</ul>
</section>
<section id="over-the-air-ota">
<h2><a class="toc-backref" href="#id11">Over-the-Air (OTA)</a><a class="headerlink" href="#over-the-air-ota" title="Permalink to this headline">¶</a></h2>
<section id="using-jfrog-bintray-free-and-secure-cloud-solution">
<h3><a class="toc-backref" href="#id12">Using JFrog Bintray (free and secure Cloud solution)</a><a class="headerlink" href="#using-jfrog-bintray-free-and-secure-cloud-solution" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Video and presentation - <a class="reference external" href="https://www.slideshare.net/ivankravets/swampup-overtheair-ota-firmware-upgrades-for-internet-of-things-devices-with-platformio-and-jfrog-bintray">swampUP: Over-The-Air (OTA) firmware upgrades for Internet of Things devices with PlatformIO and JFrog Bintray</a></p></li>
<li><p>Demo source code: <a class="reference external" href="https://github.com/platformio/bintray-secure-ota">https://github.com/platformio/bintray-secure-ota</a></p></li>
</ul>
</section>
<section id="using-built-in-local-solution">
<h3><a class="toc-backref" href="#id13">Using built-in Local solution</a><a class="headerlink" href="#using-built-in-local-solution" title="Permalink to this headline">¶</a></h3>
<p>Demo code for:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/espressif/arduino-esp32/tree/master/libraries/ArduinoOTA/examples/BasicOTA">Arduino</a></p></li>
<li><p><a class="reference external" href="https://github.com/espressif/esp-idf/tree/master/examples/system/ota">ESP-IDF</a></p></li>
</ul>
<p>There are 2 options:</p>
<ul class="simple">
<li><p>Directly specify <a class="reference internal" href="userguide/cmd_run.html#cmdoption-pio-run-upload-port"><code class="xref std std-option docutils literal notranslate"><span class="pre">pio</span> <span class="pre">run</span> <span class="pre">--upload-port</span></code></a> in command line</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pio run --target upload --upload-port IP_ADDRESS_HERE or mDNS_NAME.local
</pre></div>
</div>
<ul class="simple">
<li><p>Specify <code class="docutils literal notranslate"><span class="pre">upload_port</span></code> option in <a class="reference internal" href="config/index.html#projectconf"><span class="std std-ref">配置文件</span></a></p></li>
</ul>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:myenv]</span>
<span class="na">upload_protocol</span> <span class="o">=</span> <span class="s">espota</span>
<span class="na">upload_port</span> <span class="o">=</span> <span class="s">IP_ADDRESS_HERE or mDNS_NAME.local</span>
</pre></div>
</div>
<p>For example,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pio</span> <span class="pre">run</span> <span class="pre">-t</span> <span class="pre">upload</span> <span class="pre">--upload-port</span> <span class="pre">192.168.0.255</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pio</span> <span class="pre">run</span> <span class="pre">-t</span> <span class="pre">upload</span> <span class="pre">--upload-port</span> <span class="pre">myesp8266.local</span></code></p></li>
</ul>
<section id="authentication-and-upload-options">
<h4><a class="toc-backref" href="#id14">Authentication and upload options</a><a class="headerlink" href="#authentication-and-upload-options" title="Permalink to this headline">¶</a></h4>
<p>You can pass additional options/flags to OTA uploader using
<code class="docutils literal notranslate"><span class="pre">upload_flags</span></code> option in <a class="reference internal" href="config/index.html#projectconf"><span class="std std-ref">配置文件</span></a></p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:myenv]</span>
<span class="na">upload_protocol</span> <span class="o">=</span> <span class="s">espota</span>
<span class="c1">; each flag in a new line</span>
<span class="na">upload_flags</span> <span class="o">=</span>
    <span class="na">--port</span><span class="o">=</span><span class="s">3232</span>
</pre></div>
</div>
<p>Available flags</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--port=ESP_PORT</span></code> ESP32 OTA Port. <strong>Default 8266</strong></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--auth=AUTH</span></code> Set authentication password</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--spiffs</span></code> Use this option to transmit a SPIFFS image and do not flash
the module</p></li>
</ul>
<p>For the full list with available options please run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>~/.platformio/packages/framework-arduinoespressif32/tools/espota.py --help

Usage: espota.py <span class="o">[</span>options<span class="o">]</span>

Transmit image over the air to the esp32 module with OTA support.

Options:
  -h, --help            show this <span class="nb">help</span> message and <span class="nb">exit</span>

  Destination:
    -i ESP_IP, --ip<span class="o">=</span>ESP_IP
                        ESP32 IP Address.
    -I HOST_IP, --host_ip<span class="o">=</span>HOST_IP
                        Host IP Address.
    -p ESP_PORT, --port<span class="o">=</span>ESP_PORT
                        ESP32 ota Port. Default <span class="m">3232</span>
    -P HOST_PORT, --host_port<span class="o">=</span>HOST_PORT
                        Host server ota Port. Default random <span class="m">10000</span>-60000

  Authentication:
    -a AUTH, --auth<span class="o">=</span>AUTH
                        Set authentication password.

  Image:
    -f FILE, --file<span class="o">=</span>FILE
                        Image file.
    -s, --spiffs        Use this option to transmit a SPIFFS image and <span class="k">do</span> not
                        flash the module.

  Output:
    -d, --debug         Show debug output. And override loglevel with debug.
    -r, --progress      Show progress output. Does not work <span class="k">for</span> ArduinoIDE
    -t TIMEOUT, --timeout<span class="o">=</span>TIMEOUT
                        Timeout to <span class="nb">wait</span> <span class="k">for</span> the ESP32 to accept invitation
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For windows users. To manage OTA check the ESP wifi network profile isn’t checked on public
be sure it’s on private mode``</p>
</div>
</section>
</section>
</section>
<section id="using-arduino-framework">
<h2><a class="toc-backref" href="#id15">Using Arduino Framework</a><a class="headerlink" href="#using-arduino-framework" title="Permalink to this headline">¶</a></h2>
<p>PlatformIO will install the latest Arduino Core for ESP32 from
<a class="reference external" href="https://github.com/espressif/arduino-esp32">https://github.com/espressif/arduino-esp32</a>. The <a class="reference external" href="https://git-scm.com">Git</a>
should be installed in a system. To update Arduino Core to the latest revision,
please navigate to <code class="docutils literal notranslate"><span class="pre">PlatformIO</span> <span class="pre">Home</span> <span class="pre">&gt;</span> <span class="pre">Platforms</span> <span class="pre">&gt;</span> <span class="pre">Updates</span></code>.</p>
<blockquote>
<div><div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[env:esp32dev]</span>
<span class="na">platform</span> <span class="o">=</span> <span class="s">espressif32</span>
<span class="na">board</span> <span class="o">=</span> <span class="s">esp32dev</span>
<span class="na">framework</span> <span class="o">=</span> <span class="s">arduino</span>
<span class="na">platform_packages</span> <span class="o">=</span>
    <span class="na">platformio/framework-arduinoespressif32 @ https://github.com/espressif/arduino-esp32.git</span>
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Try to build the project</p></li>
<li><p>If you see build errors, then try to build this project using the same
<code class="docutils literal notranslate"><span class="pre">stage</span></code> with Arduino IDE</p></li>
<li><p>If it works with Arduino IDE but doesn’t work with PlatformIO, then please
<a class="reference external" href="https://github.com/platformio/platform-espressif32/issuess">file a new issue</a>
with attached information:</p>
<ul class="simple">
<li><p>test project/files</p></li>
<li><p>detailed log of build process from Arduino IDE (please copy it from
console to <a class="reference external" href="https://hastebin.com">https://hastebin.com</a>)</p></li>
<li><p>detailed log of build process from PlatformIO Build System (please copy
it from console to <a class="reference external" href="https://hastebin.com">https://hastebin.com</a>)</p></li>
</ul>
</li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">

    <p>&#169; Copyright 2021, www.OS-Q.com.</p>
<p>
  <!-- Docs: Page bottom -->
  <ins class="adsbygoogle ads"
      style="display:block;background-color: transparent;"
      data-ad-client="ca-pub-7398081349378542"
      data-ad-slot="1206527817"
      data-ad-format="auto"
      data-full-width-responsive="true"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</p>

  </div>

  
 
<script>
  var navBarHTML = '\
<div>\
  <div class="container container-fluid">\
    <div class="navbar-header">\
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navBarCollapse" aria-expanded="false">\
        <span class="sr-only">Toggle navigation</span>\
        <span class="icon-bar"></span>\
        <span class="icon-bar"></span>\
        <span class="icon-bar"></span>\
      </button>\
      <a class="navbar-brand" href="https://www.OS-Q.com" title="OS-Q"></a>\
    </div>\
    <nav role="navigation" class="collapse navbar-collapse" id="navBarCollapse">\
      <div>\
        <ul class="nav navbar-nav">\
          <li class="dropdown">\
            <a role="button" data-target="#" href="https://www.SoC.xin" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-microchip fa-lg"></i>芯芸<span class="caret"></span>\
            </a>\
            <ul class="dropdown-menu" role="menu">\
              <li role="menuitem"><a href="https://www.soc.xin"><i class="fa fa-home"></i>探索芯世界</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://docs.soc.xin"><i class="fa fa-graduation-cap"></i>Docs</a></li>\
              <li role="menuitem"><a href="https://www.github.com/socxin"><i class="fa fa-github"></i>GitHub</a></li>\
            </ul>\
          </li>\
          <li class="dropdown">\
            <a role="button" data-target="#" href="https://www.qitas.cn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-user fa-lg"></i>QITAS<span class="caret"></span>\
            </a>\
            <ul class="dropdown-menu" role="menu">\
              <li role="menuitem"><a href="https://docs.qitas.cn"><i class="fa fa-graduation-cap"></i>Docs</a></li>\
              <li role="menuitem"><a href="https://www.github.com/qitas"><i class="fa fa-github"></i>GitHub</a></li>\
            </ul>\
          </li>\
          <li class="dropdown">\
            <a role="button" data-target="#" href="https://www.stopi.cn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-cogs fa-lg"></i>石头派<span class="caret"></span>\
            </a>\
            <ul class="dropdown-menu" role="menu">\
              <li role="menuitem"><a href="https://www.stopi.cn"><i class="fa fa-home"></i>原型开发平台</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://www.github.com/sto-pi"><i class="fa fa-github"></i>STOPi</a></li>\
              <li role="menuitem"><a href="https://shop562718807.taobao.com/"><i class="fa fa-shopping-cart"></i>STOPi</a></li>\
            </ul>\
          </li>\
          <li class="dropdown">\
            <a role="button" data-target="#" href="https://stop.stops.top" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-lightbulb-o fa-lg"></i>石头铺<span class="caret"></span>\
            </a>\
            <ul class="dropdown-menu" role="menu">\
              <li role="menuitem"><a href="https://stop.stops.top"><i class="fa fa-home"></i>为生产更好的工厂</a></li>\
              <li role="separator" class="divider"></li>\
              <li role="menuitem"><a href="https://www.github.com/stopstopstop"><i class="fa fa-github"></i>GitHub</a></li>\
            </ul>\
          </li>\
        </ul>\
        <ul class="nav navbar-nav navbar-right">\
          <li class="active"><a href="https://docs.OS-Q.com"><i class="fa fa-book fa-lg"></i>Docs</a></li>\
          <li><a href="https://www.github.com/OS-Q"><i class="fa fa-github fa-lg"></i>GitHub</a></li>\
          <li class="nav-pio-tech"><a href="https://www.OS-Q.com"><i class="fa fa-heart-o fa-lg"></i>OS-Q</a></li>\
        </ul>\
      </div>\
    </nav>\
  </div>\
</div>';

  (function() {
    if (window.location.href.indexOf('http://') === 0) {
      location.href = 'https:' + window.location.href.substring(5);
    }

    var topBanner = $('.top-banner');
    var navBar = document.createElement('header');
    navBar.className = 'navbar navbar-inverse';
    navBar.innerHTML = navBarHTML;
    if (topBanner.length) {
      $(navBar).insertAfter(topBanner)
    } else {
      document.body.insertBefore(navBar, document.body.firstChild);
    }

    if ($(window).width() <= 768) {
      return;
    }

    var topOffset = 50;
    if (topBanner.length) {
      topOffset += $('.navbar').offset().top;
    }
    $('.wy-nav-side').css('top', topOffset + 'px');
    $(window).scroll(function() {
      $('.wy-nav-side').css('top', $(window).scrollTop() > topOffset ? 0 : topOffset + 'px');
    });
  })();
</script>


</footer>
        </div>
      </div>
    </section>
  </div>
  

<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book">源圈:开源项目集锦</span>
    v0.2
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>By Qtias</dt>
      <img src="../_static/images/weixin.jpg">
        <dd><a href="https://github.com/OS-Q/Docs/blob/master/source/pio/P51.rst"> View</a></dd>
        <dd><a href="https://github.com/OS-Q/Docs/edit/master/source/pio/P51.rst"> Edit</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-1768265-7"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-1768265-7', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>